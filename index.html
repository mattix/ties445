<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TIES445</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/css/reveal.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/css/theme/white.min.css">
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <h1>TIES445 Project</h1>
          <h2>D3.js</h2>
          <h2>explained with example data</h2>
          <h3>Matti & Henri</h3>
        </section>
        <section>
          <section>
            <h1>Data</h1>
            <ul>
              <li>Mortality in Finland 1891-1995</li>
            </ul>
          </section>
          <section>
            <h2>All data 1891-1995</h2>
            <iframe class="chart" src="all_data/index.html"></iframe>
          </section>
          <section>
            <h1>Challenging set of data</h1>
            <ul>
              <li>Every subset was more or less different</li>
              <li>Set contains unreliable and missing entries</li>
              <li>Needed tens of hours preprocessing and manipulation work</li>
            </ul>
          </section>
          <section>
            <h2>Something kills more nowdays</h2>
            <iframe class="chart" src="conclusion2/index.html"></iframe>
          </section>
          <section>
            <h2>And some not</h2>
            <iframe class="chart" src="conclusion1/index.html"></iframe>
          </section>
          <section>
            <h2>Differencies between mortality rates</h2>
            <iframe class="chart" src="chart_test3/index.html"></iframe>
          </section>
          <section>
            <h2>Sources</h2>
            <ul>
              <li>
                Helsingin kaupungin tietokeskus (City of Helsinki Urban Facts)
                <ul>
                  <li><a href="http://www.hel.fi/www/tieke/en" target="_blank">http://www.hel.fi/www/tieke/en</a></li>
                </ul>
              </li>
              <li>Direct links to database web interface
                <ul>
                  <li>
                    <a href="http://www.aluesarjat.fi//?bmark=../DATABASE/VANHAT_HISTORIALLISET_TILASTOT/V*196;EST*214;/V*196;EST*214;NMUUTOKSET/HIS_A06HKI_VM" target="_blank">1891-1950</a>
                  </li>
                  <li>
                    <a href="http://www.aluesarjat.fi//?bmark=../DATABASE/VANHAT_HISTORIALLISET_TILASTOT/V*196;EST*214;/V*196;EST*214;NMUUTOKSET/HIS_A07HKI_VM" target="_blank">1951-1968</a>
                  </li>
                  <li>
                    <a href="http://www.aluesarjat.fi//?bmark=../DATABASE/VANHAT_HISTORIALLISET_TILASTOT/V*196;EST*214;/V*196;EST*214;NMUUTOKSET/HIS_A08HKI_VM" target="_blank">1969-1985</a>
                  </li>
                  <li>
                    <a href="http://www.aluesarjat.fi//?bmark=../DATABASE/VANHAT_HISTORIALLISET_TILASTOT/V*196;EST*214;/V*196;EST*214;NMUUTOKSET/HIS_A09HKI_VM" target="_blank">1988-1995</a>
                  </li>
                </ul>
              </li>
            </ul>
          </section>
        </section>
        <section>
          <section>
            <h1>Domain</h1>
            <ul>
              <li>Suitable for visual representations</li>
              <li>Interesting for research on causalities</li>
            </ul>
          </section>
          <section>
            <iframe class="chart" src="bubble_matrix/bubble_matrix.html"></iframe>
          </section>
        </section>
        <section>
          <section>
            <h1>Algorithms</h1>
            <ul>
              <li>Mixed Mathlab, Ruby and C#</li>
              <li>Visualizations made mainly with <a href="https://d3js.org">d3js</a></li>
            </ul>
          </section>
          <section>
            <h1>Preprocessing (mathlab)</h1>
            <pre>
              clear;
              CSV1 = dlmread('../csv/1891-1950.csv', ';');
              [l, w] = size(CSV1);

              FIXED = eye(l, w * 5 - 4);

              FIXED(1,1) = 2;

              % Fix headers
              for i = 2:w
                years = strsplit(strrep(num2str(CSV1(1,i)), 'i', ''), '-');
                for j = 1:5
                  indx = ((i - 1) * 5 - 4) + j;
                  FIXED(1, indx) = str2num(years{1}) + j - 1;
                end
              end

              for i = 2:l
                FIXED(i, 1) = CSV1(i, 1);
                for j = 2 : w - 1
                  start_value = CSV1(i, j); end_value = CSV1(i, j + 1);
                  c = (j * 5 - 4); s = (end_value - start_value) / 5.0;
                  for h = 1:5
                    FIXED(i, c + h) = start_value + (h - 1) * s;
                  end
                end
              end
            </pre>
          </section>
          <section>
            <h1>Preprocessing (ruby)</h1>
            <pre>
              def read_ranged_csv(file)
              fixed_csv = []
              headers = true

              CSV.foreach(file, col_sep: ";", encoding: "ISO8859-1") do |row|
                row_array = []
                if headers
                  i = 0
                  row.each do |element|
                    unless element.nil?
                      start_year = element.split('-')[0].to_i
                      5.times do |j|
                        row_array[i * 5 + j - 4] = start_year + j
                      end
                    end
                    i += 1
                  end
                  headers = false
                else
                  i = 0
                  row_array << row[0].encode('utf-8')
                  for i in 1..(row.length - 1)
                    unless numeric(row[i])
                      5.times do
                        row_array << row[i]
                      end
                    else
                      start_value = row[i + 1].to_f
                      step = (start_value - row[i].to_f) / 5.0
                      5.times do |j|
                        row_array[i * 5 + j - 4] = (start_value + j * step).round(1)
                      end
                    end
                    i += 1
                  end
                end
                fixed_csv << row_array
              end
              fixed_csv
            end
            </pre>
          </section>
        </section>
        <section>
          <section>
            <h1>D3js</h1>
            <ul>
              <li>Manipulating data driven documents</li>
              <li>Relatively easy to use</li>
              <li>Very customizable</li>
              <li>Tons of examples out there</li>
              <li>Beautiful</li>
              <li>Effects</li>
              <li><a href="https://d3js.org/">https://d3js.org</a></li>
            </ul>
          </section>
          <section>
            <h1>Learn by examples</h1>
            <ul>
              <li>Barchart</li>
              <li>Binding data to views</li>
              <li>Interactive components</li>
            </ul>
          </section>
          <section>
            <h1>Barchart</h1>
            <iframe class="chart" src="barchart_example/index.html"></iframe>
          </section>
          <section>
            <h1>Steps</h1>
            <ol>
              <li>
                <a href="barchart_example/step1.txt">Empty template with styles and js</a><div class="box"><iframe src="barchart_example/step1.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="barchart_example/step2.txt">Set styles</a><div class="box"><iframe src="barchart_example/step2.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="barchart_example/step3.txt">Set data and define scaling and sizes</a><div class="box"><iframe src="barchart_example/step3.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="barchart_example/step4.txt">Create bars</a><div class="box"><iframe src="barchart_example/step4.txt" width = "500px" height = "500px"></iframe></div>
              </li>
            </ol>
          </section>
          <section>
            <h1>Binding data to views</h1>
            <iframe class="chart" src="bubble_matrix/bubble_matrix_no_data.html"></iframe>
          </section>
          <section>
            <h1>Binding data to views</h1>
            <iframe class="chart" src="bubble_matrix/bubble_matrix_uninteractive.html"></iframe>
          </section>
          <section>
            <h1>Steps</h1>
            <ol>
              <li>
                <a href="binding_example/step1.txt">Parse csv</a><div class="box"><iframe src="binding_example/step1.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="binding_example/step2.txt">Preprocess</a><div class="box"><iframe src="binding_example/step2.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="binding_example/step3.txt">Bind to svg elements</a><div class="box"><iframe src="binding_example/step3.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="binding_example/step4.txt">Scale the visual elements accordingly</a><div class="box"><iframe src="binding_example/step4.txt" width = "500px" height = "500px"></iframe></div>
              </li>
            </ol>
          </section>
          <section>
            <h1>Interactive components</h1>
            <iframe class="chart" src="bubble_matrix/bubble_matrix.html"></iframe>
          </section>
          <section>
            <h1>Steps</h1>
            <ol>
              <li>
                <a href="interactive_example/step1.txt">Implement event handler functions</a><div class="box"><iframe src="interactive_example/step1.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="interactive_example/step2.txt">Change some attributes</a><div class="box"><iframe src="interactive_example/step2.txt" width = "500px" height = "500px"></iframe></div>
              </li>
              <li>
                <a href="interactive_example/step3.txt">Bind to elements</a><div class="box"><iframe src="interactive_example/step3.txt" width = "500px" height = "500px"></iframe></div>
              </li>
            </ol>
          </section>
          <section>
            <h1>Some possibilities</h1>
          </section>
          <section>
            <h1>Fisheye zoom</h1>
            <iframe class="chart" src="fisheye_test/fisheye.html"></iframe>
          </section>
          <section>
            <h1>Sunburst chart</h1>
            <iframe class="chart" src="example2/example2.html"></iframe>
          </section>         
        </section>
        <section>
          <section>
            <h1>Further</h1>
            <p>All scripts, sources and this presentation are found in our Github page</p>
            <p><a href="https://github.com/mattix/ties445">https://github.com/mattix/ties445</a></p>
          </section>
          <section>
            <h1>Links</h1>
            <ul>
              <li><a href="https://d3js.org/">https://d3js.org</a></li>
              <li><a href="http://lab.hakim.se/reveal-js">http://lab.hakim.se/reveal-js</a></li>
            </ul>
          </section>
        </section>
      </div>
    </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/js/reveal.min.js"></script>
  <script>
      Reveal.initialize({
        width: 1280,
        height: 720
      });
  </script>
  </body>
</html>
